# miTch strict profile (production-like validation)
# Copy to .env and adjust values for your environment.

NODE_ENV=production
AUTH_TOKEN_REQUIRED=1
AUTH_TOKEN=replace-with-strong-token
RUNTIME_AUDIENCE=rp.example

# Jurisdiction hardening
REQUIRE_JURISDICTION_MATCH=1
RUNTIME_JURISDICTION=EU

# Proof-fatigue / strong re-auth
PROOF_FATIGUE_WINDOW_SECONDS=1800
PROOF_FATIGUE_MAX_HIGH_RISK_PROMPTS=3
REQUIRE_STRONG_REAUTH=1
WEBAUTHN_ASSERTION_ALLOWLIST=assertion-token-1
WEBAUTHN_CHALLENGE_ALLOWLIST=challenge-1
WEBAUTHN_RPID_ALLOWLIST=rp.example
WEBAUTHN_ORIGIN_ALLOWLIST=https://rp.example
WEBAUTHN_MAX_AGE_SECONDS=120

# Resolver quorum hardening
KEY_SOURCE_MODE=http
KEY_SOURCE_URLS=https://resolver1.example/keys,https://resolver2.example/keys,https://resolver3.example/keys
KEY_SOURCE_QUORUM=2
KEY_SOURCE_TIMEOUT_MS=1200

# Status / revocation hardening
CREDENTIAL_STATUS_MODE=http
CREDENTIAL_STATUS_URL=https://status-provider.example/revoked
CREDENTIAL_STATUS_TIMEOUT_MS=1000
CREDENTIAL_STATUS_MAX_BYTES=32768
CREDENTIAL_STATUS_REVOKED_CACHE_TTL_MS=5000
CREDENTIAL_STATUS_REVOKED_CACHE_MAX_ENTRIES=500

# DID resolver hardening prep
DID_RESOLVER_URLS=https://resolver1.example,https://resolver2.example,https://resolver3.example
DID_RESOLVER_QUORUM=2
DID_RESOLVER_TIMEOUT_MS=1200
DID_RESOLVER_ALLOW_INSECURE=0

# KPI strictness
KPI_WARN_STATUS_UNAVAILABLE_RATE=0.02
KPI_CRIT_STATUS_UNAVAILABLE_RATE=0.10
KPI_WARN_RESOLVER_INCONSISTENT_TOTAL=3
KPI_CRIT_RESOLVER_INCONSISTENT_TOTAL=10
KPI_WARN_RESOLVER_QUORUM_FAILURES_TOTAL=3
KPI_CRIT_RESOLVER_QUORUM_FAILURES_TOTAL=10
KPI_WARN_DENY_RESOLVER_QUORUM_FAILED_TOTAL=1
KPI_CRIT_DENY_RESOLVER_QUORUM_FAILED_TOTAL=5
KPI_FAIL_ON_WARNING=1
